# üîí –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

## üìã –í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: Let's Encrypt (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π, –¥–ª—è –¥–æ–º–µ–Ω–æ–≤) ‚≠ê –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è
### –í–∞—Ä–∏–∞–Ω—Ç 2: –ì–æ—Ç–æ–≤—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç CA
### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/IP –∞–¥—Ä–µ—Å–æ–≤)

---

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç 1: Let's Encrypt (Certbot) - –¥–ª—è –¥–æ–º–µ–Ω–æ–≤

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot

```bash
sudo apt update
sudo apt install -y certbot python3-certbot-nginx
```

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ your-domain.com –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
sudo certbot --nginx -d your-domain.com -d www.your-domain.com
```

Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–ª—É—á–∏—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- –ù–∞—Å—Ç—Ä–æ–∏—Ç Nginx
- –ù–∞—Å—Ç—Ä–æ–∏—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å HTTP –Ω–∞ HTTPS
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo certbot renew --dry-run
```

**–ì–æ—Ç–æ–≤–æ!** Certbot –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.

---

## üì¶ –í–∞—Ä–∏–∞–Ω—Ç 2: –ì–æ—Ç–æ–≤—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç CA

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (`.crt`, `.pem`, `.cer`) –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (`.key`):

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
sudo mkdir -p /etc/nginx/ssl

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
sudo chmod 700 /etc/nginx/ssl
```

### –®–∞–≥ 2: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∏ –∫–ª—é—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ï—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**

```bash
# –° –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (Windows/Linux/Mac)
scp certificate.crt user@server-ip:/tmp/
scp certificate.key user@server-ip:/tmp/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo mv /tmp/certificate.crt /etc/nginx/ssl/
sudo mv /tmp/certificate.key /etc/nginx/ssl/
```

**–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo nano /etc/nginx/ssl/certificate.crt
# –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–≤–∫–ª—é—á–∞—è BEGIN/END —Å—Ç—Ä–æ–∫–∏)
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+X, Y, Enter

sudo nano /etc/nginx/ssl/certificate.key
# –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+X, Y, Enter
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ö–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ root
sudo chmod 600 /etc/nginx/ssl/certificate.key
sudo chmod 644 /etc/nginx/ssl/certificate.crt
sudo chown root:root /etc/nginx/ssl/*
```

### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx

```bash
sudo nano /etc/nginx/sites-available/algospec
```

**–î–æ–±–∞–≤—å—Ç–µ SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**

```nginx
server {
    listen 80;
    listen 443 ssl;
    server_name your-domain.com www.your-domain.com;
    # –∏–ª–∏ –¥–ª—è IP: server_name _;

    # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
    ssl_certificate /etc/nginx/ssl/certificate.crt;
    ssl_certificate_key /etc/nginx/ssl/certificate.key;

    # SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';
    ssl_prefer_server_ciphers off;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;

    # –†–µ–¥–∏—Ä–µ–∫—Ç —Å HTTP –Ω–∞ HTTPS
    if ($scheme != "https") {
        return 301 https://$host$request_uri;
    }

    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Next.js —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–ø–æ—Ä—Ç 3000)
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ API –Ω–∞ NestJS –±—ç–∫–µ–Ω–¥ (–ø–æ—Ä—Ç 3001)
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo nginx -t

# –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx
sudo systemctl reload nginx
```

---

## üîß –í–∞—Ä–∏–∞–Ω—Ç 3: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/IP –∞–¥—Ä–µ—Å–æ–≤)

**–í–∞–∂–Ω–æ:** –ë—Ä–∞—É–∑–µ—Ä—ã –±—É–¥—É—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏.

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
sudo mkdir -p /etc/nginx/ssl
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/nginx/ssl/certificate.key \
  -out /etc/nginx/ssl/certificate.crt
```

**–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É–∫–∞–∂–∏—Ç–µ:**
- **Country Name (2 letter code)**: RU (–∏–ª–∏ –≤–∞—à –∫–æ–¥)
- **State or Province Name**: –≤–∞—à —Ä–µ–≥–∏–æ–Ω
- **Locality Name**: –≤–∞—à –≥–æ—Ä–æ–¥
- **Organization Name**: –≤–∞—à–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è (–∏–ª–∏ –ª—é–±–æ–µ –∏–º—è)
- **Organizational Unit Name**: (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º, Enter)
- **Common Name (CN)**: –≤–∞—à –¥–æ–º–µ–Ω –∏–ª–∏ IP –∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: `123.45.67.89` –∏–ª–∏ `your-domain.com`)
- **Email Address**: (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º, Enter)

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```bash
sudo chmod 600 /etc/nginx/ssl/certificate.key
sudo chmod 644 /etc/nginx/ssl/certificate.crt
sudo chown root:root /etc/nginx/ssl/*
```

### –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ **–í–∞—Ä–∏–∞–Ω—Ç–∞ 2, –®–∞–≥ 4**.

---

## üîß –ï—Å–ª–∏ —É –≤–∞—Å —Ç–æ–ª—å–∫–æ CSR –∏ –∫–ª—é—á

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å `certificate.csr` –∏ `certificate.key`, –Ω–æ –Ω–µ—Ç —Å–∞–º–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

### –í–∞—Ä–∏–∞–Ω—Ç A: –°–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏–∑ CSR

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo mkdir -p /etc/nginx/ssl

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ CSR –∏ –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä
# –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–π—Ç–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:
sudo openssl x509 -req -days 365 -in certificate.csr \
  -signkey certificate.key \
  -out /etc/nginx/ssl/certificate.crt

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á
sudo cp certificate.key /etc/nginx/ssl/

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞
sudo chmod 600 /etc/nginx/ssl/certificate.key
sudo chmod 644 /etc/nginx/ssl/certificate.crt
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –û—Ç–ø—Ä–∞–≤–∏—Ç—å CSR –≤ Certificate Authority

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `certificate.csr` –≤ –≤–∞—à Certificate Authority
2. –ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (`.crt` –∏–ª–∏ `.pem`)
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ **–í–∞—Ä–∏–∞–Ω—Ç–∞ 2**

---

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –æ–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

### –ë—ç–∫–µ–Ω–¥ (`backend/.env`):

```env
# –î–ª—è –¥–æ–º–µ–Ω–∞:
ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# –î–ª—è IP –∞–¥—Ä–µ—Å–∞:
ALLOWED_ORIGINS=https://123.45.67.89
```

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ (`.env.local`):

```env
# –î–ª—è –¥–æ–º–µ–Ω–∞:
NEXT_PUBLIC_API_URL=https://your-domain.com/api/auth

# –î–ª—è IP –∞–¥—Ä–µ—Å–∞:
NEXT_PUBLIC_API_URL=https://123.45.67.89/api/auth
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:

```bash
# –ë—ç–∫–µ–Ω–¥
cd /var/www/algospec/backend
pm2 restart algospec-backend

# –§—Ä–æ–Ω—Ç–µ–Ω–¥
cd /var/www/algospec
pm2 restart algospec-frontend
```

---

## üî• –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–∞ 443 –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç—å HTTPS
sudo ufw allow 443/tcp

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo ufw status
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã HTTPS

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ: `https://your-domain.com` –∏–ª–∏ `https://your-ip-address`

**–î–ª—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:**
- –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –ù–∞–∂–º–∏—Ç–µ "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" ‚Üí "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç" (–∏–ª–∏ "Advanced" ‚Üí "Proceed")

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl

```bash
# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–¥–ª—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö)
curl -k https://your-domain.com

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
curl https://your-domain.com
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
openssl s_client -connect your-domain.com:443 -servername your-domain.com

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
echo | openssl s_client -connect your-domain.com:443 2>/dev/null | \
  openssl x509 -noout -dates
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 443

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ Nginx —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 443
sudo netstat -tulpn | grep :443
# –∏–ª–∏
sudo ss -tulpn | grep :443
```

---

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "SSL certificate problem"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É
sudo ls -la /etc/nginx/ssl/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo chmod 600 /etc/nginx/ssl/certificate.key
sudo chmod 644 /etc/nginx/ssl/certificate.crt

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤
sudo cat /etc/nginx/ssl/certificate.crt | head -5
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "Certificate doesn't match domain"

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Common Name (CN) –≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –¥–æ–º–µ–Ω–æ–º
- –î–ª—è IP –∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ IP –≤ CN
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `server_name` –≤ Nginx —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å CN

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Connection refused" –Ω–∞ –ø–æ—Ä—Ç—É 443

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç 443 –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ
sudo ufw allow 443/tcp

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Nginx —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 443
sudo netstat -tulpn | grep :443

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Nginx
sudo tail -f /var/log/nginx/error.log
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–ª–æ–∫ `if ($scheme != "https")` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ `server` –±–ª–æ–∫–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 80 —Ç–∞–∫–∂–µ –æ—Ç–∫—Ä—ã—Ç: `sudo ufw allow 80/tcp`

### –ü—Ä–æ–±–ª–µ–º–∞ 5: Certbot –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å IP –∞–¥—Ä–µ—Å–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
- Certbot —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –¥–æ–º–µ–Ω–∞–º–∏
- –î–ª—è IP –∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–í–∞—Ä–∏–∞–Ω—Ç 3)

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è SSL

- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω/—Å–æ–∑–¥–∞–Ω
- [ ] –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ `/etc/nginx/ssl/`
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (600 –¥–ª—è –∫–ª—é—á–∞, 644 –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞)
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–¥–æ–±–∞–≤–ª–µ–Ω `listen 443 ssl`)
- [ ] SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ (`nginx -t`)
- [ ] Nginx –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω
- [ ] –ü–æ—Ä—Ç 443 –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π—Ä–≤–æ–ª–µ
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã (HTTPS URLs)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã
- [ ] HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–•—Ä–∞–Ω–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –∫–ª—é—á–∏ –≤ Git
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ 600
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏

2. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**
   - Let's Encrypt –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –î–ª—è –¥—Ä—É–≥–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
   - TLS 1.2 –∏ –≤—ã—à–µ
   - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —à–∏—Ñ—Ä—ã
   - HSTS –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

**–ì–æ—Ç–æ–≤–æ!** –í–∞—à —Å–∞–π—Ç —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS. üîí

