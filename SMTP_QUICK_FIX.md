# –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã SMTP ETIMEDOUT

## üîç –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç "Trying 77.88.21.158..."

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ SMTP —Å–µ—Ä–≤–µ—Ä—É Yandex. IP –∞–¥—Ä–µ—Å `77.88.21.158` - —ç—Ç–æ –∞–¥—Ä–µ—Å `smtp.yandex.ru`.

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:

### 1. –ï—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è (–≤–∏–¥–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ SMTP):

**–•–æ—Ä–æ—à–æ!** –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤:
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Nodemailer
- –¢–∞–π–º–∞—É—Ç–∞—Ö (—É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ)
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ –±—ç–∫–µ–Ω–¥
cd backend
npm run build
pm2 restart algospec-backend
```

### 2. –ï—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è (—Ç–∞–π–º–∞—É—Ç):

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∏–ª–∏ —Ñ–∞–π—Ä–≤–æ–ª –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ä—Ç.

**–†–µ—à–µ–Ω–∏—è:**

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Ä—Ç 587 –≤–º–µ—Å—Ç–æ 465

–í `backend/.env`:
```env
SMTP_PORT=587
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π SMTP —Å–µ—Ä–≤–∏—Å

**Gmail:**
```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
```

**Mail.ru:**
```env
SMTP_HOST=smtp.mail.ru
SMTP_PORT=465
SMTP_USER=your-email@mail.ru
SMTP_PASS=your-app-password
```

#### –í–∞—Ä–∏–∞–Ω—Ç C: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo ufw status

# –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
sudo ufw disable

# –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∫–ª—é—á–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ
sudo ufw enable
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –ø–æ–º–æ—â—å—é openssl (–¥–ª—è SSL –ø–æ—Ä—Ç–æ–≤):

```bash
# –î–ª—è –ø–æ—Ä—Ç–∞ 465 (SSL)
timeout 10 openssl s_client -connect smtp.yandex.ru:465 -starttls smtp

# –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏ "250" –æ—Ç–≤–µ—Ç—ã - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ 587 (STARTTLS):

```bash
telnet smtp.yandex.ru 587
# –ó–∞—Ç–µ–º –≤–≤–µ–¥–∏—Ç–µ:
EHLO test
# –î–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å: 250-...
```

## üöÄ –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

1. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Ä—Ç 587:**
   ```env
   SMTP_PORT=587
   ```

2. **–ü–µ—Ä–µ–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:**
   ```bash
   cd backend
   npm run build
   pm2 restart algospec-backend
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   ```bash
   pm2 logs algospec-backend --lines 50
   ```

## üí° –í–∞–∂–Ω–æ:

**–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ª–æ–≥–∞—Ö!** –î–∞–∂–µ –µ—Å–ª–∏ email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω:

```bash
pm2 logs algospec-backend | grep "–ö–û–î –í–ï–†–ò–§–ò–ö–ê–¶–ò–ò"
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—Ö–æ–¥–∞.

---

**–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π SMTP —Å–µ—Ä–≤–∏—Å (Gmail, Mail.ru) –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–¥ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å.

